"use strict";(self.webpackChunkspace_budz=self.webpackChunkspace_budz||[]).push([[212],{22226:function(e,t){var n={PROJECT_ID:"mainnet3eI2HGY9oDPZkQveItihr5lIP94sWWtF"};t.Z=n},14101:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var r=n(67294),a=n(35414),s=n(46953),i=n(28174),c=n(65865),l=n(75517),o=n(15861),u=n(87757),f=n.n(u),d=n(48083),m=(n(66795),n(22226)),p=n(89677);n(45476);function h(e){for(var t="",n=0;n<e.length&&"00"!==e.substr(n,2);n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t}var v=function(e){var t=[];if(t.push({unit:"lovelace",quantity:e.coin().to_str()}),e.multiasset())for(var n=e.multiasset().keys(),r=0;r<n.len();r++)for(var a=n.get(r),s=e.multiasset().get(a),i=s.keys(),c=0;c<i.len();c++){var l=i.get(c),o=s.get(l),u=Buffer.from(a.to_bytes(),"hex").toString("hex")+Buffer.from(l.name(),"hex").toString("hex");t.push({unit:u,quantity:o.to_str()})}return t},b=function(e){for(var t=[],n=e.filtered.length-1,a=0;a<=n;a++){var s=e.filtered[a];s&&s.id&&t.push(r.createElement(d.Z,{world:s,key:a}))}return t},_=function(e){var t=e.spacebudz,n=r.useState(""),a=n[0],s=n[1],i=r.useState({owned:[],bids:[],offers:[]}),u=i[0],d=i[1],_=r.useState(!0),E=_[0],w=_[1],g=(0,c.useStoreState)((function(e){return e.connection.connected})),k=r.useRef(!1),y=r.useRef(!0),N=function(){var e=(0,o.Z)(f().mark((function e(n){var r,a,s,i,c,l,o,u,b;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w(!0),d(null),r={owned:[],bids:[],offers:[]},!g){e.next=9;break}return e.next=6,window.cardano.selectedWallet.getUsedAddresses();case 6:e.t0=e.sent.map((function(e){return p.Z.Cardano.Address.from_bytes(Buffer.from(e,"hex")).to_bech32()})),e.next=10;break;case 9:e.t0=[];case 10:if(s=e.t0,i=function(e){return s.length>0&&s.some((function(t){return t===e}))},g!==n){e.next=25;break}return e.next=15,p.Z.load();case 15:return e.t1=p.Z.Cardano.Value,e.t2=Buffer,e.next=19,window.cardano.selectedWallet.getBalance();case 19:e.t3=e.sent,e.t4=e.t2.from.call(e.t2,e.t3,"hex"),c=e.t1.from_bytes.call(e.t1,e.t4),a=v(c),e.next=28;break;case 25:return e.next=27,fetch("https://cardano-mainnet.blockfrost.io/api/v0/addresses/"+n,{headers:{project_id:m.Z.PROJECT_ID}}).then((function(e){return e.json()})).then((function(e){return e.amount}));case 27:a=e.sent;case 28:return e.next=30,fetch("https://spacebudz.io/api/offers/",{headers:{project_id:m.Z.PROJECT_ID}}).then((function(e){return e.json()}));case 30:return l=e.sent,e.next=33,fetch("https://spacebudz.io/api/bids",{headers:{project_id:m.Z.PROJECT_ID}}).then((function(e){return e.json()}));case 33:o=e.sent,r.offers=l.offers.filter((function(e){return e.offer.owner==n||g===n&&i(e.offer.owner)})).map((function(e){var n=o.bids.find((function(t){return t.budId==e.budId}));return Object.assign({},t[e.budId],{listingPrice:e.offer.amount,bidPrice:n?n.bid.amount:void 0})})),r.bids=o.bids.filter((function(e){return e.bid.owner==n||g===n&&i(e.bid.owner)})).map((function(e){var n=l.offers.find((function(t){return t.budId==e.budId}));return Object.assign({},t[e.budId],{bidPrice:e.bid.amount,listingPrice:n?n.offer.amount:void 0})}));try{u=a.filter((function(e){return e.unit.startsWith("3c2cfd4f1ad33678039cfd0347cca8df363c710067d739624218abc0")})).map((function(e){console.log(h(e.unit.slice(56))),parseInt(h(e.unit.slice(56)).split("WorldsWithin")[1])})),b=u.map((function(e){var n=o.bids.find((function(t){return t.budId==e}));return Object.assign({},t[e-1],{bidPrice:n?n.bid.amount:void 0})})),r.owned=b}catch(f){}d(r),w(!1);case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,o.Z)(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="undefined"!=typeof window&&new URL(window.location.href).searchParams.get("address"),s(t),N(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.useEffect((function(){var e=document.createElement("script");e.src="/js/app.js",document.body.appendChild(e)}),[]),r.useEffect((function(){k.current?g&&!y.current?window.history.pushState({},null,"/profile?address="+g):y.current=!1:k.current=!0,window.scrollTo(0,0),x()}),[g]),r.useEffect((function(){var e=window.location.href,t=setInterval((function(){var t=window.location.href;e!==t&&(e=t,x())}));return function(){return clearInterval(t)}}),[]),r.createElement(c.StoreProvider,{store:l.Z},r.createElement("div",{className:"outer__inner"},r.createElement("div",{className:"profile"},r.createElement("div",{className:"profile__head js-profile-head",style:{backgroundImage:"url('/img/content/bg-profile.jpg')"}},r.createElement("div",{className:"profile__center center"},r.createElement("div",{className:"profile__file"},r.createElement("input",{type:"file"}),r.createElement("div",{className:"profile__wrap"},r.createElement("svg",{className:"icon icon-upload-file"},r.createElement("use",{xlinkHref:"#icon-upload-file"})),r.createElement("div",{className:"profile__info"},"Drag and drop your photo here"),r.createElement("div",{className:"profile__text"},"or click to browse")),r.createElement("button",{className:"button-small profile__button js-profile-save"},"Save photo")))),r.createElement("div",{className:"profile__body"},r.createElement("div",{className:"profile__center center"},r.createElement("div",{className:"user"},r.createElement("div",{className:"user__avatar"},r.createElement("img",{src:"/img/icon-owner.png",alt:"Avatar"})),r.createElement("div",{className:"user__code"},r.createElement("div",{className:"user__number",onClick:function(){return window.open("https://cardanoscan.io/address/"+a)},style:{cursor:"pointer"}},a),r.createElement("button",{className:"user__copy"},r.createElement("svg",{className:"icon icon-copy"},r.createElement("use",{xlinkHref:"#icon-copy"}))))),r.createElement("div",{className:"profile__wrapper js-tabs"},r.createElement("div",{className:"profile__nav"},r.createElement("a",{className:"profile__link js-tabs-link active",href:"#"},"Open Bids (",E?"...":u.bids.length,")"),r.createElement("a",{className:"profile__link js-tabs-link",href:"#"},"Listed (",E?"...":u.offers.length,")"),r.createElement("a",{className:"profile__link js-tabs-link",href:"#"},"Owned (",E?"...":u.owned.length+u.offers.length,")")),r.createElement("div",{className:"profile__container"},r.createElement("div",{className:"profile__item js-tabs-item",style:{display:"block"}},r.createElement("div",{className:"profile__list"},E?r.createElement("img",{src:"/img/loader.gif",alt:"Loader"}):r.createElement(b,{filtered:u.bids}))),r.createElement("div",{className:"profile__item js-tabs-item"},r.createElement("div",{className:"profile__list"},E?r.createElement("img",{src:"/img/loader.gif",alt:"Loader"}):r.createElement(b,{filtered:u.offers}))),r.createElement("div",{className:"profile__item js-tabs-item"},r.createElement("div",{className:"profile__list"},E?r.createElement("img",{src:"/img/loader.gif",alt:"Loader"}):r.createElement(b,{filtered:u.owned}))))))))))},E=function(e){var t=e.pageContext.spacebudz;return r.createElement(c.StoreProvider,{store:l.Z},r.createElement(a.q,null,r.createElement("title",null,"Worlds Within Marketplace"),r.createElement("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),r.createElement("link",{href:"https://fonts.googleapis.com/css2?family=DM+Sans:wght@700&family=Poppins:wght@400;500;600;700&display=swap",rel:"stylesheet"}),r.createElement("link",{rel:"stylesheet",media:"all",href:"/css/app.min.css"}),r.createElement("link",{rel:"stylesheet",media:"all",href:"/css/overrides.css"}),r.createElement("script",null,"var viewportmeta = document.querySelector('meta[name=\"viewport\"]');\n\t\t\t  if (viewportmeta) {\n\t\t\t\tif (screen.width < 375) {\n\t\t\t\t  var newScale = screen.width / 375;\n\t\t\t\t  viewportmeta.content = 'width=375, minimum-scale=' + newScale + ', maximum-scale=1.0, user-scalable=no, initial-scale=' + newScale + '';\n\t\t\t\t} else {\n\t\t\t\t  viewportmeta.content = 'width=device-width, maximum-scale=1.0, initial-scale=1.0';\n\t\t\t\t}\n\t\t\t  }")),r.createElement(s.Z,null),r.createElement(_,{spacebudz:t}),r.createElement(i.Z,null))}}}]);
//# sourceMappingURL=component---src-templates-profile-js-de42e461699261e04865.js.map